---
title: Partial hydration
---

One of Capri's core features is that it supports partial hydration, also known
as [islands architecture](https://jasonformat.com/islands-architecture/). This
means that Capri sites will by default ship zero KB of JavaScript to the
browser. If you need some interactivity on your pages, you can selectively
_hydrate_ these components.

## Creating islands

Create a regular React/Preact/SolidJS component and name it `*.island.(tsx|jsx)`.

Import the `island` function to create a higher order component like this:

```tsx
// Counter.island.tsx

import { useState } from "preact/hooks";
import { island } from "@capri-js/preact";

function Counter() {
  const [counter, setCounter] = useState(0);
  return (
    <div>
      {counter}
      <button onClick={() => setCounter((c) => c + 1)}>+</button>
    </div>
  );
}

export const CounterIsland = island(Counter);
```

<Note>
  The name of the export doesn't matter, you can also use a default export if
  you want.
</Note>

Use that wrapped component in your app to opt in to client-side hydration for that particular subtree:

```ts
// App.tsx

import { CounterIsland } from "./Counter.island";

export function App() {
  return (
    <main>
      <h1>
        Welcome to <i>Capri</i>
      </h1>
      <div>This page is static, but contains some dynamic parts.</div>
      <div>
        Here is a simple counter: <CounterIsland />
      </div>
      <div>
        And here is another one, independent of the one above:
        <CounterIsland start={100} />
      </div>
    </main>
  );
}
```

## Static child content

Child components that are passed from a parent on to an island are only rendered on the
server. Upon hydration, the children are replaced by a single component that returns the
static HTML as it was initially rendered. Therefore, the `children` property won't be included
in the island marker script, where all other initial props are serialized.

This allows you to use Capri islands for things like navigation menus or accordion components
that are hard to implement with other partial hydration solutions.

## Island options

### `media: string`

Only hydrate the component when the given media query matches. In the following example
the hydration of the component will be deferred until the viewport width gets below 700 pixels:

```ts
// BurgerMenu.island.tsx

function BurgerMenu() {
  // ...
}

export const BurgerMenuIsland = island(BurgerMenu, {
  media: "(max-width: 700px)",
});
```

<Note title="Stay tuned">
  We are planing to add more options, for example to only hydrate islands that
  are within the viewport.
</Note>
